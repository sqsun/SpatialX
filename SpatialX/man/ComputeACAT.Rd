% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilties.R
\name{ComputeACAT}
\alias{ComputeACAT}
\title{Combine p-values using Aggregated Cauchy Association Test (ACAT)}
\usage{
ComputeACAT(Pvals, Weights = NULL)
}
\arguments{
\item{Pvals}{A numeric vector of p-values to be combined. P-values should be
between 0 and 1. NA values will be removed with a warning.}

\item{Weights}{An optional numeric vector of weights for each p-value.
If NULL (default), equal weights are used. Weights should be
non-negative and will be normalized to sum to 1.}
}
\value{
A single numeric value representing the combined p-value using the
        ACAT method. The returned value is between 0 and 1.
}
\description{
This function implements the ACAT method for combining p-values from multiple
tests or kernels. ACAT is particularly effective for combining dependent
p-values and is widely used in genetic association studies and spatial
analysis where test statistics may be correlated.
}
\details{
The Aggregated Cauchy Association Test (ACAT) combines p-values by:
\enumerate{
  \item Transforming each p-value using the Cauchy transformation:
        \eqn{w_i \cdot \tan((0.5 - p_i) \cdot \pi)}
  \item Summing the transformed values
  \item Converting the sum back to a p-value using the Cauchy cumulative
        distribution function
}

ACAT has several advantages:
\itemize{
  \item Robust to dependencies between tests
  \item Powerful under various alternative hypotheses
  \item Computationally efficient
  \item Works well with both small and large numbers of tests
}

The method automatically handles extreme p-values:
\itemize{
  \item If any p-value is 0, the combined p-value is 0
  \item P-values of 1 are adjusted to 1 - Îµ to avoid numerical issues
  \item NA values are removed with a warning
}
}
\examples{
\dontrun{
# Combine p-values with equal weights
pvals <- c(0.01, 0.05, 0.1, 0.2)
combined_p <- ComputeACAT(pvals)

# Combine p-values with custom weights
weights <- c(2, 1, 1, 2)
combined_p_weighted <- ComputeACAT(pvals, weights)

# Handle extreme values
extreme_pvals <- c(0, 0.001, 0.5, 1)
combined_extreme <- ComputeACAT(extreme_pvals)

# Use in spatial analysis with multiple kernel p-values
kernel_pvals <- c(0.03, 0.07, 0.12, 0.25, 0.08)
spatial_combined <- ComputeACAT(kernel_pvals)
}

}
\references{
Liu Y., et al. (2019). ACAT: A Fast and Powerful p Value Combination
Method for Rare-Variant Analysis in Sequencing Studies.
The American Journal of Human Genetics, 104(3), 410-421.
}
\seealso{
\code{\link[stats]{p.adjust}} for other p-value adjustment methods
}
