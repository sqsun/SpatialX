% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilties.R
\name{AggrSquareBin}
\alias{AggrSquareBin}
\title{Aggregate spots using square binning}
\usage{
AggrSquareBin(
  counts,
  location,
  cell.type = NULL,
  bin.fold = 2,
  num.core = 1,
  verbose = TRUE
)
}
\arguments{
\item{counts}{Gene expression counts matrix with features as rows and spots
as columns. Column names should be in the format "location_x x location_y"
or compatible with the spatial coordinates.}

\item{location}{Spatial location information for each spot. Should be a
data.frame or matrix with rows corresponding to spots and
columns for spatial coordinates (x and y).}

\item{cell.type}{Cell type information for each spot, particularly useful
for high-resolution technologies like HDST. Can be a vector
or matrix with cell type assignments or proportions.}

\item{bin.fold}{The fold for zooming in (aggregation factor). Must be an
integer (e.g., 2, 3, 4). A value of 2 will combine 2x2 spots
into one bin, 3 will combine 3x3 spots, etc.}

\item{num.core}{Number of CPU cores to use for parallel processing. Default is 1.}

\item{verbose}{Logical indicating whether to print progress messages. Default is TRUE.}
}
\value{
Returns a list with the following components:
\itemize{
  \item \code{counts}: Aggregated gene expression counts matrix
  \item \code{location}: Updated spatial coordinates for each bin (center points)
  \item \code{cell.type}: Aggregated cell type composition (if provided)
  \item \code{bin.assignment}: Mapping of original spots to bin identifiers
}
}
\description{
This function decreases the resolution of spatial transcriptomics data by
aggregating neighboring spots into square bins. This is particularly useful
for data with very high spatial resolution (e.g., HDST, Slide-seq) where
binning can improve signal-to-noise ratio and computational efficiency.
}
\details{
Square binning aggregates neighboring spots into larger square regions,
effectively reducing spatial resolution while increasing counts per bin.
This approach is beneficial for:
\itemize{
  \item Reducing technical noise in high-resolution spatial data
  \item Improving statistical power for lowly expressed genes
  \item Decreasing computational requirements for downstream analysis
  \item Matching resolutions across different spatial technologies
}

The function works by:
\enumerate{
  \item Dividing the spatial coordinates into a grid of square bins
  \item Aggregating counts within each bin (summation)
  \item Calculating bin centroids as new spatial coordinates
  \item Optionally aggregating cell type information (proportions or counts)
}
}
\examples{
\dontrun{
# Load high-resolution spatial data
data(hdst_data)

# Aggregate 2x2 spots into bins
binned_data <- AggrSquareBin(
  counts = hdst_counts,
  location = hdst_locations,
  bin.fold = 2,
  num.core = 4
)

# Aggregate with cell type information
binned_data_with_ct <- AggrSquareBin(
  counts = hdst_counts,
  location = hdst_locations,
  cell.type = hdst_celltypes,
  bin.fold = 3,
  verbose = TRUE
)

# Access the binned data
binned_counts <- binned_data$counts
binned_locations <- binned_data$location
bin_assignments <- binned_data$bin.assignment

# Compare dimensions before and after binning
dim(hdst_counts)      # Original dimensions
dim(binned_counts)    # Binned dimensions
}

}
\seealso{
\code{\link{ComputeBandWidth}}
}
