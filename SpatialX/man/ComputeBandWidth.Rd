% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilties.R
\name{ComputeBandWidth}
\alias{ComputeBandWidth}
\title{Select bandwidth for Gaussian kernel}
\usage{
ComputeBandWidth(
  norm_counts,
  location = NULL,
  method = "Silverman",
  num.core = 2
)
}
\arguments{
\item{norm_counts}{A normalized gene expression matrix with genes as rows and
spatial locations as columns. Should be normalized and
scaled appropriately for spatial analysis.}

\item{location}{Optional spatial coordinates data.frame or matrix with rows
corresponding to spatial locations and columns for coordinates
(typically x and y). If provided, uses spatial distances for
bandwidth selection.}

\item{method}{Method for bandwidth selection. Options include:
\itemize{
  \item "Silverman": Silverman's rule of thumb, suitable for large sample sizes
  \item "SJ": Sheather-Jones method, more accurate for small sample sizes
  \item "Scott": Scott's rule for multivariate data
  \item "UCV": Unbiased cross-validation
  \item "BCV": Biased cross-validation
}
Default is "Silverman".}

\item{num.core}{Number of CPU cores to use for parallel computation when
applicable. Default is 2.}
}
\value{
A numeric value representing the calculated bandwidth for Gaussian
        kernel smoothing. This value can be used directly in spatial
        smoothing functions.
}
\description{
This function selects an appropriate bandwidth for Gaussian kernel smoothing
in spatial transcriptomics analysis. The bandwidth parameter controls the
spatial scale of smoothing and is crucial for proper spatial pattern
detection and noise reduction.
}
\details{
Bandwidth selection is critical for Gaussian kernel smoothing in spatial
transcriptomics:
\itemize{
  \item Too small bandwidth: Overfitting, noise amplification
  \item Too large bandwidth: Over-smoothing, loss of spatial patterns
}

The available methods have different characteristics:
\describe{
  \item{Silverman}{Fast rule-of-thumb based on standard deviation and sample size.
        Best for normally distributed data and large samples.}
  \item{SJ (Sheather-Jones)}{Plug-in method that estimates the optimal bandwidth
        by estimating the density's curvature. More accurate for small samples
        and non-normal distributions.}
  \item{Scott}{Multivariate extension of Silverman's rule. Suitable for
        spatial coordinates when provided.}
  \item{Cross-validation methods}{Computationally intensive but data-driven
        approaches that minimize prediction error.}
}

When spatial coordinates are provided, the function calculates bandwidth
based on spatial distances. Otherwise, it uses expression distances between
spatial locations.
}
\examples{
\dontrun{
# Using normalized expression data only
normalized_data <- normalize_counts(raw_counts)
bandwidth1 <- ComputeBandWidth(normalized_data, method = "Silverman")

# Using spatial coordinates for more accurate bandwidth
spatial_coords <- GetSpatialCoordinates(spatial_object)
bandwidth2 <- ComputeBandWidth(normalized_data, 
                              location = spatial_coords, 
                              method = "SJ")

# Using cross-validation for optimal bandwidth
bandwidth3 <- ComputeBandWidth(normalized_data, 
                              location = spatial_coords,
                              method = "UCV",
                              num.core = 4)

}

}
